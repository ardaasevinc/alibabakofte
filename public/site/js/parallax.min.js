// 1. Olay dinleyici fonksiyonunu güvenli hale getiriyoruz
function s(e) {
    // Sadece olay iptal edilebilir (cancelable) ise preventDefault çağır
    if (e.cancelable && typeof e.preventDefault === 'function') {
        e.preventDefault();
    }
    
    // Smooth scroll hesaplamaları
    x = e.notRealWheel 
        ? -e.deltaY / 4 
        : (e.deltaMode == 1 ? -e.deltaY / 3 : (Math.abs(e.deltaY) === 100 ? -e.deltaY / 120 : -e.deltaY / 40));
        
    x = -H > x ? -H : x;
    x = x > H ? H : x;
    p = !0;
    g = D;
}

// 2. addWheelListener fonksiyonunu modern 'passive: false' desteğiyle güncelle
(function(window, document) {
    var prefix = "", _addEventListener, support;

    if (window.addEventListener) {
        _addEventListener = "addEventListener";
    } else {
        _addEventListener = "attachEvent";
        prefix = "on";
    }

    support = "onwheel" in document.createElement("div") ? "wheel" :
              document.onmousewheel !== undefined ? "mousewheel" : "DOMMouseScroll";

    window.addWheelListener = function(elem, callback, useCapture) {
        // Modern tarayıcılar için passive: false zorunlu hale getiriliyor
        var options = false;
        if (typeof useCapture === 'object') {
            options = useCapture;
        } else {
            options = {
                capture: useCapture || false,
                passive: false // Hatanın ana çözümü burası
            };
        }
        
        _addWheelListener(elem, support, callback, options);

        if (support == "DOMMouseScroll") {
            _addWheelListener(elem, "MozMousePixelScroll", callback, options);
        }
    };

    function _addWheelListener(elem, eventName, callback, options) {
        elem[_addEventListener](prefix + eventName, support == "wheel" ? callback : function(originalEvent) {
            !originalEvent && (originalEvent = window.event);
            var event = {
                originalEvent: originalEvent,
                target: originalEvent.target || originalEvent.srcElement,
                type: "wheel",
                deltaMode: originalEvent.type == "MozMousePixelScroll" ? 0 : 1,
                deltaX: 0,
                deltaZ: 0,
                notRealWheel: 1,
                preventDefault: function() {
                    if (originalEvent.cancelable) {
                        originalEvent.preventDefault ? originalEvent.preventDefault() : (originalEvent.returnValue = false);
                    }
                }
            };
            
            if (support == "mousewheel") {
                event.deltaY = -1 / 40 * originalEvent.wheelDelta;
                originalEvent.wheelDeltaX && (event.deltaX = -1 / 40 * originalEvent.wheelDeltaX);
            } else {
                event.deltaY = originalEvent.detail / 3;
            }
            return callback(event);
        }, options);
    }
})(window, document);